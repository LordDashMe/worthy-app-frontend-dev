"use strict";!function(){function s(){alert("Done, please check logs for more info.")}function u(e){var t=new Date,n=t.getFullYear()+"-"+("00"+(t.getMonth()+1)).slice(-2)+"-"+("00"+t.getDate()).slice(-2)+" "+("00"+t.getHours()).slice(-2)+":"+("00"+t.getMinutes()).slice(-2)+":"+("00"+t.getSeconds()).slice(-2),o=document.getElementById("logs");o.value+="["+n+"]: "+e+"\n",o.scrollTop=o.scrollHeight}function a(e){document.getElementById("status").textContent="["+e.toUpperCase()+"]"}function d(e){return e.ok?e.json():Promise.reject(e)}function r(e){"function"==typeof e.json?e.json().then(function(e){alert(e.message),console.error(e.message),u("ERROR: "+e.message)}):console.error(e)}var l="https://worthy-app-backend.herokuapp.com",o="/user/login",t="/data-source",c="/data-source/entry";document.getElementById("get_token").addEventListener("click",function(){var e=document.getElementById("username").value,t=document.getElementById("password").value;u("LOADING AUTH");var n={method:"POST",headers:{"Content-Type":"application/json","X-WORTHY-APP-HEADER":1},body:JSON.stringify({userName:e,password:t})};fetch(l+o,n).then(d).then(function(e){s(),document.getElementById("token").value=e.token,u("DONE")}).catch(r)}),document.getElementById("set_post_action").addEventListener("click",function(o){var e=document.getElementById("token").value,a=document.getElementById("data_source_system_name").value;u("LOADING DATA SOURCE: "+a);var c=l+t+"/"+a;fetch(c,{method:"GET",headers:{"Content-Type":"application/json","X-WORTHY-APP-HEADER":1,"X-WORTHY-APP-JWT":e}}).then(d).then(function(e){s(),document.getElementById("data_source_url").value=c,document.getElementById("data_source_action").value=o;var t,n={};for(t in e.fields)n[e.fields[t].systemName]=function(e){switch(e){case"String":return"";case"Date":return"0000-00-00";case"Number":return 0}}(e.fields[t].dataType);document.getElementById("data_source_body").value=JSON.stringify({systemName:a,fields:n},null,4),u("DONE")}).catch(r)}.bind(this,"POST")),document.getElementById("commit_action").addEventListener("click",function(){var e=document.getElementById("token").value,t=document.getElementById("data_source_action").value,n=document.getElementById("data_source_body").value;u("EXECUTING COMMIT"),u(n),a("PROCESSING");var o={method:t,headers:{"Content-Type":"application/json","X-WORTHY-APP-HEADER":1,"X-WORTHY-APP-JWT":e}};"POST"!==t&&"PATCH"!==t||(o.body=n),fetch(l+c,o).then(d).then(function(e){s(),document.getElementById("data_source_output").value=JSON.stringify(e,null,4),u("DONE"),a("IDLE")}).catch(r)})}();