"use strict";!function(){function c(){alert("Done, please check logs for more info.")}function d(e){var t=new Date,n=t.getFullYear()+"-"+("00"+(t.getMonth()+1)).slice(-2)+"-"+("00"+t.getDate()).slice(-2)+" "+("00"+t.getHours()).slice(-2)+":"+("00"+t.getMinutes()).slice(-2)+":"+("00"+t.getSeconds()).slice(-2),o=document.getElementById("logs");o.value+="["+n+"]: "+e+"\n",o.scrollTop=o.scrollHeight}function u(e){document.getElementById("status").textContent="["+e.toUpperCase()+"]"}function s(e){return e.ok?e.json():Promise.reject(e)}function l(e){"function"==typeof e.json?e.json().then(function(e){document.getElementById("data_source_output").value=e.message,alert(e.message),console.error(e.message),d("ERROR: "+e.message)}):console.error(e)}function e(t){var n=document.getElementById("token").value,o=document.getElementById("data_source_system_name").value;d("LOADING DATA SOURCE: "+o+" with action "+t),"POST"===t?function(){document.getElementById("data_source_form_body").hidden=!1,document.getElementById("data_source_url").value=a+(r+"/entry"),document.getElementById("data_source_action").value=t;var e=a+(r+"/"+o);fetch(e,{method:"GET",headers:{"Content-Type":"application/json","X-WORTHY-APP-HEADER":1,"X-WORTHY-APP-JWT":n}}).then(s).then(function(e){c();var t,n={};for(t in e.fields)n[e.fields[t].systemName]=function(e){switch(e){case"String":return"";case"Date":return"0000-00-00";case"Number":return 0}}(e.fields[t].dataType);document.getElementById("data_source_body").value=JSON.stringify({systemName:o,fields:n},null,4),d("DONE")}).catch(l)}():"GET"===t&&(document.getElementById("data_source_form_body").hidden=!0,document.getElementById("data_source_url").value=a+(r+"/"+o+"/entries"),document.getElementById("data_source_action").value=t)}var a="https://worthy-app-backend.herokuapp.com",o="/user/login",r="/data-source";document.getElementById("get_token").addEventListener("click",function(){var e=document.getElementById("username").value,t=document.getElementById("password").value;d("LOADING AUTH");var n={method:"POST",headers:{"Content-Type":"application/json","X-WORTHY-APP-HEADER":1},body:JSON.stringify({userName:e,password:t})};fetch(a+o,n).then(s).then(function(e){c(),document.getElementById("token").value=e.token,d("DONE")}).catch(l)}),document.getElementById("set_get_action").addEventListener("click",e.bind(this,"GET")),document.getElementById("set_post_action").addEventListener("click",e.bind(this,"POST")),document.getElementById("commit_action").addEventListener("click",function(){var e=document.getElementById("token").value,t=document.getElementById("data_source_url").value,n=document.getElementById("data_source_action").value,o=document.getElementById("data_source_body").value;d("EXECUTING COMMIT"),"POST"===n&&d(o),u("PROCESSING");var a={method:n,headers:{"Content-Type":"application/json","X-WORTHY-APP-HEADER":1,"X-WORTHY-APP-JWT":e}};"POST"!==n&&"PATCH"!==n||(a.body=o),fetch(t,a).then(s).then(function(e){c(),document.getElementById("data_source_output").value=JSON.stringify(e,null,4),d("DONE"),u("IDLE")}).catch(l)})}();