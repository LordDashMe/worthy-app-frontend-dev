"use strict";!function(){function e(e,t){var n,o=document.getElementById("token").value,c=document.getElementById("data_source_system_name").value;l("LOADING DATA SOURCE: "+c+" with action "+e),"POST"===e?(document.getElementById("data_source_form_body").hidden=!1,document.getElementById("data_source_url").value=a.source+s(),document.getElementById("data_source_action").value=e,n=a.source+u(c),fetch(n,{method:"GET",headers:{"Content-Type":"application/json","X-WORTHY-APP-HEADER":1,"X-WORTHY-APP-JWT":o}}).then(m).then(function(e){r();var t,n={};for(t in e.fields)n[e.fields[t].systemName]=i(e.fields[t].dataType);document.getElementById("data_source_body").value=JSON.stringify({systemName:c,fields:n},null,4),l("DONE")}).catch(E)):"GET"===e&&(document.getElementById("data_source_form_body").hidden=!0,document.getElementById("data_source_url").value=a.source+d(c),document.getElementById("data_source_action").value=e)}var a={source:"https://worthy-app-backend-h20.herokuapp.com",auth:"/user/login",data_source:"/data-source"},u=function(e){return a.data_source+"/"+e},d=function(e){return a.data_source+"/"+e+"/entries"},s=function(){return a.data_source+"/entry"},r=function(){alert("Done, please check logs for more info.")},l=function(e){var t=new Date,t=t.getFullYear()+"-"+("00"+(t.getMonth()+1)).slice(-2)+"-"+("00"+t.getDate()).slice(-2)+" "+("00"+t.getHours()).slice(-2)+":"+("00"+t.getMinutes()).slice(-2)+":"+("00"+t.getSeconds()).slice(-2),n=document.getElementById("logs");n.value+="["+t+"]: "+e+"\n",n.scrollTop=n.scrollHeight},c=function(e){document.getElementById("status").textContent="["+e.toUpperCase()+"]"},i=function(e){switch(e){case"String":return"";case"Date":return"0000-00-00";case"Number":return 0}},m=function(e){return e.ok?e.json():Promise.reject(e)},E=function(e){"function"==typeof e.json?e.json().then(function(e){document.getElementById("data_source_output").value=e.message,alert(e.message),console.error(e.message),l("ERROR: "+e.message)}):console.error(e)};document.getElementById("get_token").addEventListener("click",function(){var e=document.getElementById("username").value,t=document.getElementById("password").value,e=(l("LOADING AUTH"),{method:"POST",headers:{"Content-Type":"application/json","X-WORTHY-APP-HEADER":1},body:JSON.stringify({userName:e,password:t})});fetch(a.source+a.auth,e).then(m).then(function(e){r(),document.getElementById("token").value=e.token,l("DONE")}).catch(E)}),document.getElementById("set_get_action").addEventListener("click",e.bind(this,"GET")),document.getElementById("set_post_action").addEventListener("click",e.bind(this,"POST")),document.getElementById("commit_action").addEventListener("click",function(){var e=document.getElementById("token").value,t=document.getElementById("data_source_url").value,n=document.getElementById("data_source_action").value,o=document.getElementById("data_source_body").value,e=(l("EXECUTING COMMIT"),"POST"===n&&l(o),c("PROCESSING"),{method:n,headers:{"Content-Type":"application/json","X-WORTHY-APP-HEADER":1,"X-WORTHY-APP-JWT":e}});"POST"!==n&&"PATCH"!==n||(e.body=o),fetch(t,e).then(m).then(function(e){r(),document.getElementById("data_source_output").value=JSON.stringify(e,null,4),l("DONE"),c("IDLE")}).catch(E)})}();