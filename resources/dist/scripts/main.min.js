"use strict";!function(){function o(e){var t=new Date,n=t.getFullYear()+"-"+("00"+(t.getMonth()+1)).slice(-2)+"-"+("00"+t.getDate()).slice(-2)+" "+("00"+t.getHours()).slice(-2)+":"+("00"+t.getMinutes()).slice(-2)+":"+("00"+t.getSeconds()).slice(-2);document.getElementById("logs").value+="["+n+"]: "+e+"\n"}function c(e){document.getElementById("status").textContent="["+e.toUpperCase()+"]"}function s(e){return e.ok?e.json():Promise.reject(e)}function u(e){e.json().then(function(e){alert(e.message),console.error(e.message),o("ERROR: "+e.message)})}var d="https://worthy-app-backend.herokuapp.com",a="/user/login",t="/data-source",r="/data-source/entry";document.getElementById("get_token").addEventListener("click",function(){var e=document.getElementById("username").value,t=document.getElementById("password").value;o("LOADING AUTH");var n={method:"POST",headers:{"Content-Type":"application/json","X-WORTHY-APP-HEADER":1},body:JSON.stringify({userName:e,password:t})};fetch(d+a,n).then(s).then(function(e){document.getElementById("token").value=e.token,o("DONE")}).catch(u)}),document.getElementById("set_create_action").addEventListener("click",function(a){var e=document.getElementById("token").value,c=document.getElementById("data_source_system_name").value;o("LOADING DATA SOURCE: "+c),fetch(d+t+"/"+c,{method:"GET",headers:{"Content-Type":"application/json","X-WORTHY-APP-HEADER":1,"X-WORTHY-APP-JWT":e}}).then(s).then(function(e){document.getElementById("current_data_source").value=c,document.getElementById("current_action").value=a;var t,n={};for(t in e.fields)n[e.fields[t].systemName]=function(e){switch(e){case"String":return"";case"Date":return"0000-00-00";case"Number":return 0}}(e.fields[t].dataType);document.getElementById("details").value=JSON.stringify({systemName:c,fields:n},null,4),o("DONE")}).catch(u)}.bind(this,"CREATE")),document.getElementById("commit_action").addEventListener("click",function(){var e=document.getElementById("token").value,t=document.getElementById("current_action").value,n=document.getElementById("details").value;o("EXECUTING COMMIT"),o(n),c("PROCESSING");var a={method:function(e){switch(e){case"CREATE":return"POST";case"UPDATE":return"PATCH"}}(t),headers:{"Content-Type":"application/json","X-WORTHY-APP-HEADER":1,"X-WORTHY-APP-JWT":e},body:n};fetch(d+r,a).then(s).then(function(e){alert(e.message),o("DONE"),c("IDLE")}).catch(u)})}();